System.register(["./styles-8b67d7cb-legacy-3cece900.js","./index-legacy-a6b6faca.js","./layout-legacy-3f67b00e.js","./line-legacy-5bf25857.js","./array-legacy-bc791948.js","./path-legacy-f4cdb9e9.js"],(function(t,e){"use strict";var a,r,i,n,d,o,s,l,p,c,g,h,f;return{setters:[function(t){a=t.p,r=t.d,i=t.s},function(t){n=t.c,d=t.l,o=t.h,s=t.i,l=t.F,p=t.z,c=t.G},function(t){g=t.G,h=t.l},function(t){f=t.l},null,null],execute:function(){var e=0,x=function(t){var e=t.id;return t.type&&(e+="<"+c(t.type)+">"),e},u=function(t,e,a,r){var i=e.getDisplayDetails(),n=i.displayText,d=i.cssStyle,o=t.append("tspan").attr("x",r.padding).text(n);""!==d&&o.attr("style",e.cssStyle),a||o.attr("dy",r.textHeight)},y=function(t,e,a,r){d.debug("Rendering class ",e,a);var i,n=e.id,o={id:n,label:e.id,width:0,height:0},s=t.append("g").attr("id",r.db.lookUpDomId(n)).attr("class","classGroup");i=e.link?s.append("svg:a").attr("xlink:href",e.link).attr("target",e.linkTarget).append("text").attr("y",a.textHeight+a.padding).attr("x",0):s.append("text").attr("y",a.textHeight+a.padding).attr("x",0);var l=!0;e.annotations.forEach((function(t){var e=i.append("tspan").text("«"+t+"»");l||e.attr("dy",a.textHeight),l=!1}));var p=x(e),c=i.append("tspan").text(p).attr("class","title");l||c.attr("dy",a.textHeight);var g,h,f,y=i.node().getBBox().height;if(e.members.length>0){g=s.append("line").attr("x1",0).attr("y1",a.padding+y+a.dividerMargin/2).attr("y2",a.padding+y+a.dividerMargin/2);var v=s.append("text").attr("x",a.padding).attr("y",y+a.dividerMargin+a.textHeight).attr("fill","white").attr("class","classText");l=!0,e.members.forEach((function(t){u(v,t,l,a),l=!1})),h=v.node().getBBox()}if(e.methods.length>0){f=s.append("line").attr("x1",0).attr("y1",a.padding+y+a.dividerMargin+h.height).attr("y2",a.padding+y+a.dividerMargin+h.height);var b=s.append("text").attr("x",a.padding).attr("y",y+2*a.dividerMargin+h.height+a.textHeight).attr("fill","white").attr("class","classText");l=!0,e.methods.forEach((function(t){u(b,t,l,a),l=!1}))}var m=s.node().getBBox(),k=" ";e.cssClasses.length>0&&(k+=e.cssClasses.join(" "));var w=s.insert("rect",":first-child").attr("x",0).attr("y",0).attr("width",m.width+2*a.padding).attr("height",m.height+a.padding+.5*a.dividerMargin).attr("class",k).node().getBBox().width;return i.node().childNodes.forEach((function(t){t.setAttribute("x",(w-t.getBBox().width)/2)})),e.tooltip&&i.insert("title").text(e.tooltip),g&&g.attr("x2",w),f&&f.attr("x2",w),o.width=w,o.height=m.height+a.padding+.5*a.dividerMargin,o},v=function(t,a,r,i,n){var o=function(t){switch(t){case n.db.relationType.AGGREGATION:return"aggregation";case n.db.relationType.EXTENSION:return"extension";case n.db.relationType.COMPOSITION:return"composition";case n.db.relationType.DEPENDENCY:return"dependency";case n.db.relationType.LOLLIPOP:return"lollipop"}};a.points=a.points.filter((function(t){return!Number.isNaN(t.y)}));var s,c,g=a.points,h=f().x((function(t){return t.x})).y((function(t){return t.y})).curve(l),x=t.append("path").attr("d",h(g)).attr("id","edge"+e).attr("class","relation"),u="";i.arrowMarkerAbsolute&&(u=(u=(u=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search).replace(/\(/g,"\\(")).replace(/\)/g,"\\)")),1==r.relation.lineType&&x.attr("class","relation dashed-line"),10==r.relation.lineType&&x.attr("class","relation dotted-line"),"none"!==r.relation.type1&&x.attr("marker-start","url("+u+"#"+o(r.relation.type1)+"Start)"),"none"!==r.relation.type2&&x.attr("marker-end","url("+u+"#"+o(r.relation.type2)+"End)");var y,v,b,m,k=a.points.length,w=p.calcLabelPosition(a.points);if(s=w.x,c=w.y,k%2!=0&&k>1){var L=p.calcCardinalityPosition("none"!==r.relation.type1,a.points,a.points[0]),E=p.calcCardinalityPosition("none"!==r.relation.type2,a.points,a.points[k-1]);d.debug("cardinality_1_point "+JSON.stringify(L)),d.debug("cardinality_2_point "+JSON.stringify(E)),y=L.x,v=L.y,b=E.x,m=E.y}if(void 0!==r.title){var M=t.append("g").attr("class","classLabel"),N=M.append("text").attr("class","label").attr("x",s).attr("y",c).attr("fill","red").attr("text-anchor","middle").text(r.title);window.label=N;var T=N.node().getBBox();M.insert("rect",":first-child").attr("class","box").attr("x",T.x-i.padding/2).attr("y",T.y-i.padding/2).attr("width",T.width+i.padding).attr("height",T.height+i.padding)}d.info("Rendering relation "+JSON.stringify(r)),void 0!==r.relationTitle1&&"none"!==r.relationTitle1&&t.append("g").attr("class","cardinality").append("text").attr("class","type1").attr("x",y).attr("y",v).attr("fill","black").attr("font-size","6").text(r.relationTitle1),void 0!==r.relationTitle2&&"none"!==r.relationTitle2&&t.append("g").attr("class","cardinality").append("text").attr("class","type2").attr("x",b).attr("y",m).attr("fill","black").attr("font-size","6").text(r.relationTitle2),e++},b=function(t,e,a,r){d.debug("Rendering note ",e,a);var i=e.id,n={id:i,text:e.text,width:0,height:0},o=t.append("g").attr("id",i).attr("class","classGroup"),s=o.append("text").attr("y",a.textHeight+a.padding).attr("x",0),l=JSON.parse('"'.concat(e.text,'"')).split("\n");l.forEach((function(t){d.debug("Adding line: ".concat(t)),s.append("tspan").text(t).attr("class","title").attr("dy",a.textHeight)}));var p=o.node().getBBox(),c=o.insert("rect",":first-child").attr("x",0).attr("y",0).attr("width",p.width+2*a.padding).attr("height",p.height+l.length*a.textHeight+a.padding+.5*a.dividerMargin).node().getBBox().width;return s.node().childNodes.forEach((function(t){t.setAttribute("x",(c-t.getBBox().width)/2)})),n.width=c,n.height=p.height+l.length*a.textHeight+a.padding+.5*a.dividerMargin,n},m={},k=function(t){var e=Object.entries(m).find((function(e){return e[1].label===t}));if(e)return e[0]};t("diagram",{parser:a,db:r,renderer:{draw:function(t,e,a,r){var i=n().class;m={},d.info("Rendering diagram "+t);var l,p=n().securityLevel;"sandbox"===p&&(l=o("#i"+e));var c,f=o("sandbox"===p?l.nodes()[0].contentDocument.body:"body"),x=f.select("[id='".concat(e,"']"));(c=x).append("defs").append("marker").attr("id","extensionStart").attr("class","extension").attr("refX",0).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 1,7 L18,13 V 1 Z"),c.append("defs").append("marker").attr("id","extensionEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 1,1 V 13 L18,7 Z"),c.append("defs").append("marker").attr("id","compositionStart").attr("class","extension").attr("refX",0).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),c.append("defs").append("marker").attr("id","compositionEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),c.append("defs").append("marker").attr("id","aggregationStart").attr("class","extension").attr("refX",0).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),c.append("defs").append("marker").attr("id","aggregationEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),c.append("defs").append("marker").attr("id","dependencyStart").attr("class","extension").attr("refX",0).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 5,7 L9,13 L1,7 L9,1 Z"),c.append("defs").append("marker").attr("id","dependencyEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L14,7 L9,1 Z");var u=new g({multigraph:!0});u.setGraph({isMultiGraph:!0}),u.setDefaultEdgeLabel((function(){return{}}));for(var w=r.db.getClasses(),L=0,E=Object.keys(w);L<E.length;L++){var M=E[L],N=w[M],T=y(x,N,i,r);m[T.id]=T,u.setNode(T.id,T),d.info("Org height: "+T.height)}r.db.getRelations().forEach((function(t){d.info("tjoho"+k(t.id1)+k(t.id2)+JSON.stringify(t)),u.setEdge(k(t.id1),k(t.id2),{relation:t},t.title||"DEFAULT")})),r.db.getNotes().forEach((function(t){d.debug("Adding note: ".concat(JSON.stringify(t)));var e=b(x,t,i,r);m[e.id]=e,u.setNode(e.id,e),t.class&&t.class in w&&u.setEdge(t.id,k(t.class),{relation:{id1:t.id,id2:t.class,relation:{type1:"none",type2:"none",lineType:10}}},"DEFAULT")})),h(u),u.nodes().forEach((function(t){void 0!==t&&void 0!==u.node(t)&&(d.debug("Node "+t+": "+JSON.stringify(u.node(t))),f.select("#"+(r.db.lookUpDomId(t)||t)).attr("transform","translate("+(u.node(t).x-u.node(t).width/2)+","+(u.node(t).y-u.node(t).height/2)+" )"))})),u.edges().forEach((function(t){void 0!==t&&void 0!==u.edge(t)&&(d.debug("Edge "+t.v+" -> "+t.w+": "+JSON.stringify(u.edge(t))),v(x,u.edge(t),u.edge(t).relation,i,r))}));var B=x.node().getBBox(),H=B.width+40,O=B.height+40;s(x,O,H,i.useMaxWidth);var S="".concat(B.x-20," ").concat(B.y-20," ").concat(H," ").concat(O);d.debug("viewBox ".concat(S)),x.attr("viewBox",S)}},styles:i,init:function(t){t.class||(t.class={}),t.class.arrowMarkerAbsolute=t.arrowMarkerAbsolute,r.clear()}})}}}));
